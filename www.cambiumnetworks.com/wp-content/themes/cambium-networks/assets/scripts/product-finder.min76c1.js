jQuery(document).ready(function(){function showResults(title){jQuery(allFeeds).hide(),jQuery(noProducts).hide(),jQuery(resultsHeader).show(),jQuery(filtersClearAll).show(),results.classList.remove("hidden"),results.querySelectorAll(".pf-product:not(.hidden)").length||(jQuery(noProducts).show(),jQuery(resultsHeader).hide(),results.classList.add("hidden")),setResultsTitle(title),jQuery(filtersClearAll).show()}function showFeeds(){jQuery(allFeeds).show(),jQuery(noProducts).hide(),jQuery(resultsHeader).hide(),results.classList.add("hidden")}function filterSearchResults(){results.querySelectorAll(".pf-product").forEach(function(elem){elem.textContent.match(qsRegex)?elem.classList.remove("hidden"):elem.classList.add("hidden")})}function filterResults(){results.querySelectorAll(".pf-product").forEach(function(elem){elem.classList.add("hidden")}),results.querySelectorAll(getFilters()).forEach(function(elem){qsRegex?elem.textContent.match(qsRegex)&&elem.classList.remove("hidden"):elem.classList.remove("hidden")})}function hideClearAll(){jQuery(filtersClearAll).hide()}function resetQuickSearch(){document.getElementById("quicksearch").value="",qsRegex=!1}function resetCategoryFilters(){categorySelectors=["*"]}function resetProductFilters(){taxonomySelectors={},productFilterContainer.querySelectorAll(".filter-button").forEach(function(elem){isAllLink(elem)?elem.classList.add("is-checked"):elem.classList.remove("is-checked")})}function resetFilters(){resetCategoryFilters(),resetProductFilters(),hideClearAll()}function getFilters(){var filters=[];return categorySelectors.forEach(function(selector){filters.push(selector+concatValues(taxonomySelectors))}),filters.join(", ")}function setFilters(filterGroup,filter){"category"==filterGroup?categorySelectors="*"==filter?["*"]:filter.split(","):taxonomySelectors[filterGroup]="*"==filter?"":filter}function concatValues(obj){var value="";for(var prop in obj)value+=obj[prop];return value}function getProductHTML(product){for(var term_slugs=[],footer_output="",output="",taxonomy_includes=["wdscn-product-frequency","wdscn-product-streams","wdscn-product-technology","wdscn-product-location","wdscn-product-management"],j=0;j<product.terms.length;j++)term_slugs.push(product.terms[j].taxonomy.replace("wdscn-product-","")+"-"+product.terms[j].slug),-1!=taxonomy_includes.indexOf(product.terms[j].taxonomy)&&(footer_output+='<div class="product-card__frequency" data-taxonomy="'+product.terms[j].taxonomy+'">'+product.terms[j].name+"</div>");return output+="<article id="+product.id+' class="pf-product product-card product-card--grid has-post-thumbnail item '+term_slugs.join(" ")+'">',output+='<div class="product-card__thumbnail">',output+='<a href="'+product.link+'" target="_self">',output+='<img src="'+product.featured_image_url+'" /></a></div>',output+='<div class="product-card__content">',output+='<h3 class="h4">',output+='<a href="'+product.link+'">',output+=product.title+"</a></h3>",output+="<p>"+product.excerpt+"</p></div>",footer_output&&(output+='<footer class="product-card__footer">'+footer_output+"</footer>"),output+="</article>"}function getCategoryById(termId){for(var i=0;i<categoryData.length;i++)if(termId==categoryData[i].term_id)return categoryData[i]}function findProductsByTermId(termId){var data=[];return productData.forEach(function(product){for(var j=0;j<product.terms.length;j++){var term=product.terms[j];if(termId==term.term_id){data.push(product);break}}}),data}function createFeedHTML(categories,level){level=level||1,categories=Array.isArray(categories)?categories:[categories],categories.forEach(function(term){var headlineElem=1==level?document.createElement("h2"):document.createElement("h3");headlineElem.classList.add("pf-products__headline"),headlineElem.textContent=term.name,allFeeds.appendChild(headlineElem);var products=findProductsByTermId(term.term_id),containerElem=document.createElement("div");containerElem.classList.add("pf-products"),allFeeds.appendChild(containerElem),products.forEach(function(product){containerElem.innerHTML+=getProductHTML(product)}),term.children.length&&createFeedHTML(term.children,level+1)})}function isAllLink(elem){return"*"==elem.getAttribute("data-filter")}function isFilterLink(elem){return elem.matches(".filter-button")}function isCategoryLink(elem){return!!isFilterLink(elem)&&"category"==elem.closest(".button-group").getAttribute("data-filter-group")}function getCurrentCategoryLink(){return document.querySelector(".prod-category .filter-button.is-checked")}function getCurrentCategorySelector(appendSelector){var filter=getCurrentCategoryLink().getAttribute("data-filter");if(!appendSelector)return filter;var filters=[];return("*"==filter?["*"]:filter.split(",")).forEach(function(selector){filters.push(selector+appendSelector)}),filters.join(", ")}function toggleProductFilters(){productFilterContainer.querySelectorAll(".filter-button[id]").forEach(function(elem){var selector=getCurrentCategorySelector(elem.getAttribute("data-filter"));results.querySelector(selector)?elem.removeAttribute("disabled"):elem.setAttribute("disabled","disabled")}),productFilterContainer.querySelectorAll(".product-filter-selector").forEach(function(elem){var totalLinks=elem.querySelectorAll(".filter-button[id]").length;elem.querySelectorAll(".filter-button[id][disabled]").length==totalLinks?elem.classList.add("hidden"):elem.classList.remove("hidden")})}function hideProductFilters(){productFilterContainer.querySelectorAll(".product-filter-selector").forEach(function(elem){elem.classList.add("hidden")})}function setResultsTitle(title){resultsHeader.innerHTML=title||getCurrentCategoryLink().textContent+" &mdash; Filtered Results"}if(document.querySelector("body.page-product-finder")){var results=document.getElementById("pf-results"),resultsHeader=document.getElementById("product-finder-header"),allFeeds=document.getElementById("pf-feeds"),noProducts=document.getElementById("no-products-found"),productFilterContainer=document.getElementById("product-filters"),filtersClearAll=document.getElementById("cn-clear-filters"),qsRegex=!1,categorySelectors=["*"],taxonomySelectors={};filtersClearAll.addEventListener("click",function(){jQuery(allFeeds).show(),jQuery(noProducts).hide(),jQuery(resultsHeader).hide(),results.classList.add("hidden"),resetProductFilters(),resetQuickSearch(),jQuery(filtersClearAll).hide()}),document.addEventListener("click",function(e){if(isFilterLink(e.target)){e.preventDefault();var btnElem=e.target,groupElem=btnElem.closest(".button-group"),filterGroup=groupElem.getAttribute("data-filter-group"),filter=btnElem.getAttribute("data-filter");groupElem.querySelectorAll(".is-checked").forEach(function(elem){elem.classList.remove("is-checked")}),btnElem.classList.add("is-checked"),resetQuickSearch();var isAll=isAllLink(btnElem),isCategory=isCategoryLink(btnElem);if(isCategory&&(resetFilters(),isAll?hideProductFilters():toggleProductFilters()),isCategory&&isAll||isCategory){if(resetFilters(),setFilters(filterGroup,filter),isAll)allFeeds.innerHTML="",createFeedHTML(categoryData);else{allFeeds.innerHTML="";createFeedHTML(getCategoryById(btnElem.getAttribute("id")))}showFeeds()}else setFilters(filterGroup,filter),filterResults(),showResults(isCategory?getCurrentCategoryLink().textContent:"")}}),document.getElementById("quicksearch").addEventListener("keyup",function(fn,threshold){var timeout;return threshold=threshold||100,function(){function delayed(){fn.apply(_this,args)}clearTimeout(timeout);var args=arguments,_this=this;timeout=setTimeout(delayed,threshold)}}(function(){this.value?(qsRegex=new RegExp(this.value,"gi"),resetProductFilters(),filterSearchResults(),showResults("All Products &mdash; Search Results")):(resetQuickSearch(),filterResults(),showResults())},500)),jQuery("#myForm").on("keyup keypress",function(e){if(13===(e.keyCode||e.which))return e.preventDefault(),!1});var productData=JSON.parse(document.getElementById("pf-data--products").textContent),categoryData=JSON.parse(document.getElementById("pf-data--categories").textContent);productData&&function(products){for(var output="",i=0;i<products.length;i++)output+=getProductHTML(products[i]);results.innerHTML=output}(productData),document.querySelector(".products-preloader").classList.add("hidden");var categoryLink=document.querySelector(".prod-category .filter-button");categoryLink.onclick?categoryLink.onclick():categoryLink.click&&categoryLink.click()}});